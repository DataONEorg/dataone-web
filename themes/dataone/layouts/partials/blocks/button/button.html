<!-- in order to pass on page parameters from within loops  -->
{{ $page := .Page }} 

{{ $link := .Block.link }}
{{- if not .Block.external_website -}}
	{{ if .Block.website_link }}
		{{ $link = ref .Page .Block.website_link }}
	{{ end }}
{{- end -}}
{{ if (eq .Block.link "ContactUsLink") }}
	{{ $link = .Page.Site.Params.contactLink }}
{{ end }}
{{ if (eq .Block.link "JoinFormLink") }}
	{{ $link = print .Page.RelPermalink "#" .Page.Site.Params.joinFormId }}
{{ end }}

<a
  class="button
         button--{{ with .Block.type }}{{- . -}}{{ else }}secondary{{ end }}
         {{ with .Block.class }} {{- . -}}{{ end }}"
  href="{{- $link -}}"
>
  {{ .Block.text }}
</a>
