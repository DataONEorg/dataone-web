<!-- in order to pass on page parameters from within loops -->
{{ $page := .Page }}
<!-- blockname -->
{{ $bn := "header" }}

{{ $tagline := .Block.tagline | default "Data Observation Network for Earth" }}

{{ $bkgImgs := .Block.images | default slice }}

<!-- Pick a random image from the image gallery to start with -->
{{ $src := index (shuffle $bkgImgs) 1 | default ""  }}
{{ $bkgImg := "" }}
{{ with $src }}
  {{ $imageResource := partial "functions/getImage" (dict "image" . "Page" $page) }}
  {{ if gt $imageResource.Width 4000 }}
    {{ $imageResource = $imageResource.Resize "4000x" }}
  {{ end }}
  {{ $bkgImg = printf ` style="--background-image:url('%s');"` $imageResource.RelPermalink | safeHTMLAttr  }}
{{ end }}

<header id="homepage_header" class="header header--hero-image header--overlay-subtle header--homepage" {{ $bkgImg }}>
  <div class="header__content">
    <div class="header__logo">

      {{- partial "blocks/logo/logo" (dict "Block" (dict "type" "homepage") "Page" $page ) -}}
    </div>

    {{ with $tagline}}
      <div class="header__tagline">
        {{ $tagline }}
      </div>
    {{ end }}

    <div class="header__search">
      {{- partial "blocks/d1search/d1search" (dict "Block" .Block "Page" $page ) -}}
    </div>

    <!-- Parameters for the advanced search button -->
    {{ $buttonParams := dict "type" "external website" "external_link" "https://search.dataone.org/data" "text" "Advanced search" "color" "quaternary" }}
    {{ partial "blocks/button/button" (dict "Block" $buttonParams "Page" $page )}}

  </div>

</header>
<section class="{{ $bn }}__logos">
  {{ $buttonBlock := dict "type" "internal page" "color" "quaternary" "text" "See our entire network" "internal_link" "/network/_index.md" }}
  {{ $logosBarBlock := dict "button" $buttonBlock "use_member_nodes" true }}
  {{ partial "blocks/logos-bar/logos-bar" (dict "Block" $logosBarBlock "Page" $page) }}
</section>
