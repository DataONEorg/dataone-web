<!-- in order to pass on page parameters from within loops -->
{{- $page := .Page -}}
<!-- The prefix we will add to the CSS classes -->
{{- $p := $page.Site.Params.prefix -}}
<!-- The name of this block -->
{{- $bn := print $p "join-form" -}}
<!-- classes to add to the outer element -->
{{- $classes := $bn -}}

<!-- === Newsletter & service sign up form === -->
<!-- HTML taken from MaielrLite with most <style></style> content removed, -->
<!-- and some hugo templating options added. -->
<!-- Note that the .classes are required for the MailerLite javascript to work. -->

{{- $checkHR := "" -}}
{{- $checkPlus := "" -}}
{{- $checkNL := "" -}}
{{- if eq .Block.precheck_hostedrepo true -}}
  {{- $checkHR = "checked" -}}
{{- end -}}
{{- if eq .Block.precheck_plus true -}}
  {{- $checkPlus = "checked" -}}
{{- end -}}
{{- if eq .Block.precheck_mailing_list true -}}
  {{- $checkNL = "checked" -}}
{{- end -}}
<!-- if the block should just be a simple newsletter signup -->
{{- if .Block.mailing_list_only -}}
  {{- $checkHR = "" -}}
  {{- $checkPlus = "" -}}
  {{- $checkNL = "checked" -}}
  {{- $classes = print $classes " " $bn "--mailing-list-only" -}}
{{- end -}}

{{- with .Block.style -}}
  {{- $classes = printf "%s %s--%s" $classes $bn ( . | urlize ) -}}
{{- end -}}

<div id="join-form" class="{{- $classes -}}">
  <div id="mlb2-1647596" class="ml-form-embedContainer ml-subscribe-form ml-subscribe-form-1647596">
    <div class="ml-form-align-center">
      <div class="ml-form-embedWrapper embedForm">
        <div class="ml-form-embedBody ml-form-embedBodyDefault row-form">
          <div class="ml-form-embedContent" style="margin-bottom:0"></div>
          <form class="ml-block-form" action="https://app.mailerlite.com/webforms/submit/b7u9a7" data-code="b7u9a7" method="post" target="_blank">
            <div class="ml-form-formContent">
              <div class="ml-form-fieldRow ml-last-item">
                <div class="ml-field-group ml-field-email ml-validate-email ml-validate-required">
                  <input type="email" class="form-control" data-inputmask="" name="fields[email]" placeholder="ada.lovelace@example.com" autocomplete="email" id="newsletter-email" required="true" aria-required="true">
                  <label class="{{- $bn -}}__label" for="newsletter-email">E-mail address (required)</label>
                </div>
              </div>
            </div>
            <div class="ml-form-interestGroupsRow ml-block-groups">
              <div class="ml-form-interestGroupsRowCheckbox last-group" style="">
                <label>
                  <input type="checkbox" name="groups[]" value="76427432" {{- $checkHR -}}>
                  <div class="label-description">Get started with a Hosted Repository from DataONE</div>
                </label>
              </div>
              <div class="ml-form-interestGroupsRowCheckbox group" style="">
                <label>
                  <input type="checkbox" name="groups[]" value="76427356" {{- $checkPlus -}}>
                  <div class="label-description">Get more information on the DataONE Plus portals service</div>
                </label>
              </div>
              <div class="ml-form-interestGroupsRowCheckbox group" style="">
                <label>
                  <input type="checkbox" name="groups[]" value="9902726" {{- $checkNL -}}>
                  <div class="label-description">Subscribe to the community mailing list</div>
                </label>
              </div>
            </div>
            <style type="text/css">
              .ml-form-recaptcha {
                margin-bottom: 20px;
                float: left;
              }
              .ml-form-recaptcha.ml-error iframe {
                border: solid 1px red;
              }
              @media screen and (max-width:768px) {
                .ml-form-recaptcha {
                  transform: scale(.77);
                  -webkit-transform: scale(.77);
                  transform-origin: 0 0;
                  -webkit-transform-origin: 0 0;
                }
              }
            </style>
            <input type="hidden" name="ml-submit" value="1">
            <div class="ml-form-embedSubmit">
              <button type="submit" class="primary">Get connected</button>
              <button disabled="disabled" style="display:none" type="button" class="loading">
                <div class="ml-form-embedSubmitLoad">
                  <div></div>
                  <div></div>
                  <div></div>
                  <div></div>
                </div>
              </button>
            </div>
          </form>
        </div>
        <div class="ml-form-successBody row-success" style="display:none">
          <div class="ml-form-successContent">
            <p class="response-text">Please check your e-mail</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    function ml_webform_success_1647596() {
      var r = ml_jQuery || jQuery;
      r(".ml-subscribe-form-1647596 .row-success").show(),
      r(".ml-subscribe-form-1647596 .row-form").hide()
    }
  </script>
  <img src="https://track.mailerlite.com/webforms/o/1647596/b7u9a7?v4a60e9ef938a7fa0240ac9ba567062cb" width="1" height="1" style="max-width:1px;max-height:1px;visibility:hidden;padding:0;margin:0;display:block" border="0">
  <script src="https://static.mailerlite.com/js/w/webforms.min.js?v4a60e9ef938a7fa0240ac9ba567062cb" type="text/javascript"></script>
</div>
