{{- define "main" -}}

  <!-- ========================================== VARIABLES ========================================== -->

  <!-- in order to pass on page parameters from within loops -->
  {{ $page := $.Page }}

  <!-- webinar parameters -->
  {{ $webinar := $.Page.Params }}

  <!-- status defines whether this webinar is upcoming, happening now, or past -->
  {{ $status := partial "functions/getWebinarStatus" $webinar }}
  <!-- Set the pill text based on status -->
  {{ $pillBlock := partial "functions/getWebinarPill" $status }}
  <!-- add status as a modifier class -->
  {{ $classes := "" }}
  {{ with $status }}
    {{ $classes = print $classes " webinar--st-" $status }}
  {{ end }}

  <!-- ========================================== BLOCKS ========================================== -->

  {{ $readMore := ` <span class="header__read-more">Read more</span>`}}
  {{ $intro := print $webinar.short_abstract $readMore | safeHTML}}
  {{ $headerBlock := dict "template" "header" "type" "webinar" "title" $webinar.title "intro" $intro "abstract" $webinar.abstract "speakers" $webinar.speakers "duration" $webinar.duration "pill" $pillBlock}}
  {{ $webinarBlock := merge (dict "template" "webinar-details") $webinar }}
  {{ $sectionBlock:= dict "template" "section" "type" "split" "background" "secondary" "background2" "neutral-light" "blocks" (slice $headerBlock $webinarBlock) }}
  {{ partial "blocks/section/section" (dict "Block" $sectionBlock "Page" $.Page) }}

{{- end -}}